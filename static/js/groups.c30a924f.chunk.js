(this["webpackJsonp@react-testsql/client"]=this["webpackJsonp@react-testsql/client"]||[]).push([[2],{333:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(26),r=function(e,t){var a=new Blob([t],{type:"application/x-sqlite-3"}),r=new FormData;return r.set("database",a),fetch("/api/database/save/".concat(e),{method:"POST",body:r,credentials:"same-origin"}).then(n.a).then((function(e){return e.json()}))},o=function(e){return fetch("/api/database/load/".concat(e),{method:"GET",credentials:"same-origin"}).then(n.a).then((function(e){return e.arrayBuffer()}))},l=function(e){return fetch("/api/database/delete/".concat(e),{method:"GET",credentials:"same-origin"}).then(n.a)},c=function(){return fetch("/api/database/list",{method:"GET",credentials:"same-origin",headers:new Headers({"Content-Type":"application/json"})}).then(n.a).then((function(e){return e.json()}))}},792:function(e,t,a){},806:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Ue}));var n=a(10),r=a(13),o=a(12),l=a(11),c=a(0),i=a.n(c),s=a(265),u=a(437),m=a(23),d=a.n(m),p=a(34),h=a(264),f=a(272),v=a(274),b=a(266),E=a(267),g=a(268),y=a(319),x=a(333),j=a(263),C=a(216),O=a(287),k=a(288),w=a(63),S=a(628),G=a.n(S),H=a(627),A=a.n(H),B={progress:{flex:"0 0 40px"},smallButton:{padding:6}},D=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handleJoinGroup=function(){return e.props.joinGroupHandler(e.props.group._id)},e.handleLeaveGroup=function(){return e.props.leaveGroupHandler()},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.group,a=e.dense,n=t._id,r=t.title,o=t.completedQuestions,l=void 0===o?"-":o,c=t.totalQuestions,s=void 0===c?"-":c,u=t.canManage,m=t.isCurrent;return i.a.createElement(C.a,{onClick:this.handleJoinGroup,disabled:m,selected:m,component:"li",button:!0},i.a.createElement(w.a,{color:"textSecondary",style:B.progress,title:"You have completed ".concat(l," out of ").concat(s," questions in this group.")},"".concat(l,"/").concat(s)),i.a.createElement(O.a,{primary:r}),(u||m)&&i.a.createElement(k.a,null,u&&i.a.createElement(j.a,{style:a&&B.smallButton||{},component:y.b,to:"/group/manage/".concat(n,"/").concat(r),title:"Manage this group","aria-label":"Manage group"},i.a.createElement(A.a,{fontSize:"small"})),m&&i.a.createElement(j.a,{style:a&&B.smallButton||{},color:"secondary",onClick:this.handleLeaveGroup,title:"Leave this group","aria-label":"Leave current group"},i.a.createElement(G.a,{fontSize:"small"}))))}}]),a}(i.a.Component),_=a(95),q=function(){return localStorage.removeItem("__testSQL_Questions__")},T={display:"flex",justifyContent:"space-between"},z=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={list:null,error:null},e.componentDidMount=function(){return e.load()},e.load=Object(p.a)(d.a.mark((function t(){var a,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(_.e)();case 3:a=t.sent,e.setState({list:a,error:null}),t.next=13;break;case 7:return t.prev=7,t.t0=t.catch(0),t.next=11,t.t0.text();case 11:n=t.sent,e.setState({error:n});case 13:case"end":return t.stop()}}),t,null,[[0,7]])}))),e.handleClose=function(){return e.props.closeHandler()},e.handleJoinGroup=function(){var t=Object(p.a)(d.a.mark((function t(a){var n,r,o,l,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(_.c)(a);case 3:return n=t.sent,e.props.joinGroupHandler(n),t.next=7,Object(x.c)(n.database);case 7:r=t.sent,o=new Uint8Array(r),e.props.loadDatabaseHandler(o),l=e.state.list.map((function(e){return e.isCurrent=n._id===e._id,e})),e.setState({list:l,error:null}),t.next=23;break;case 14:return t.prev=14,t.t0=t.catch(0),t.next=18,t.t0.text();case 18:return c=t.sent,e.setState({error:c}),t.next=22,Object(_.d)();case 22:e.props.leaveGroupHandler();case 23:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLeaveGroup=Object(p.a)(d.a.mark((function t(){var a,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(_.d)();case 3:a=e.state.list.map((function(e){return e.isCurrent=!1,e})),q(),e.props.leaveGroupHandler(),e.setState({list:a,error:null}),t.next=15;break;case 9:return t.prev=9,t.t0=t.catch(0),t.next=13,t.t0.text();case 13:n=t.sent,e.setState({error:n});case 15:case"end":return t.stop()}}),t,null,[[0,9]])}))),e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.list,n=t.error;return i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,{id:"dialog-title"},i.a.createElement("div",{style:T},"Groups",i.a.createElement(h.a,{component:y.b,to:"/group/create",color:"primary",variant:"contained",size:"small"},"Create \xbb"))),n&&i.a.createElement(E.a,null,i.a.createElement(g.a,{color:"error",align:"center"},n)),i.a.createElement(E.a,null,i.a.createElement(g.a,null,"Groups allow you to customize the experience and track the progress of every user that joins your group.")),a&&i.a.createElement(f.a,{dense:a.length>=5},a.map((function(t){return i.a.createElement(D,{key:t._id,group:t,joinGroupHandler:e.handleJoinGroup,leaveGroupHandler:e.handleLeaveGroup,dense:a.length>=5})}))),i.a.createElement(v.a,null,i.a.createElement(h.a,{onClick:this.handleClose,color:"primary"},"Close")))}}]),a}(i.a.Component),L=a(38),Q=a(804),M=a(269),R=a(271),K=a(273),P=a(290),F=a(280),U={display:"flex",justifyContent:"space-between"},W=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={error:null,list:null,name:"",selectedDatabase:"",redirect:!1},e.componentDidMount=function(){return Object(x.b)().then((function(t){return e.setState({list:t})}))},e.handleSubmit=Object(p.a)(d.a.mark((function t(){var a,n,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state,n=a.name,r=a.selectedDatabase,t.prev=1,t.next=4,Object(_.a)(n,r);case 4:e.setState({redirect:!0}),t.next=13;break;case 7:return t.prev=7,t.t0=t.catch(1),t.next=11,t.t0.text();case 11:o=t.sent,e.setState({error:o});case 13:case"end":return t.stop()}}),t,null,[[1,7]])}))),e.handleChange=function(t){e.setState(Object(L.a)({},t.target.name,t.target.value))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.error,n=e.list,r=e.selectedDatabase;return e.redirect?i.a.createElement(u.a,{to:"/"}):i.a.createElement("div",null,i.a.createElement(b.a,{id:"dialog-title",style:U,disableTypography:!0},i.a.createElement(w.a,{variant:"h6"},"Creating a new group"),i.a.createElement(h.a,{component:y.b,color:"secondary",variant:"contained",size:"small",to:"/"},"\xab Back")),i.a.createElement(E.a,null,i.a.createElement(g.a,null,"A group allows others to join and share a common database allowing the group owner to customize and track their user's experience.")),i.a.createElement(E.a,null,i.a.createElement(Q.a,{container:!0,spacing:3},i.a.createElement(Q.a,{item:!0,xs:3},i.a.createElement(w.a,{align:"right"},"Group Name")),i.a.createElement(Q.a,{item:!0,xs:9},i.a.createElement(R.a,{error:Boolean(a),"aria-describedby":"name-error-text",fullWidth:!0},i.a.createElement(M.a,{id:"name",name:"name",value:t,onChange:this.handleChange,margin:"dense",autoFocus:!0,fullWidth:!0}),a&&i.a.createElement(K.a,{id:"name-error-text"},a))),i.a.createElement(Q.a,{item:!0,xs:3},i.a.createElement(w.a,{align:"right"},"Shared Database")),i.a.createElement(Q.a,{item:!0,xs:9},i.a.createElement(R.a,{fullWidth:!0},i.a.createElement(P.a,{value:r,onChange:this.handleChange,inputProps:{name:"selectedDatabase",id:"selectedDatabase"},fullWidth:!0},n&&n.length?n.map((function(e){return i.a.createElement(F.a,{key:e._id,value:e._id},e.title)})):i.a.createElement(F.a,{disabled:!0},i.a.createElement("em",null,"No saved databases!"))),i.a.createElement(K.a,null,"This will list all of your saved databases."))))),i.a.createElement(v.a,null,i.a.createElement(h.a,{onClick:this.props.closeHandler,color:"primary"},"Close"),i.a.createElement(h.a,{onClick:this.handleSubmit,color:"primary",variant:"contained"},"Create")))}}]),a}(i.a.Component),J=a(53),N=a(36),I=a(404),Y=a.n(I),V=a(661),X=a.n(V),Z=a(517),$=a.n(Z),ee=a(520),te=a.n(ee),ae=a(521),ne=a.n(ae),re=a(756),oe=a.n(re),le=a(357),ce=a.n(le),ie=a(384),se=a.n(ie),ue={},me=function(e){if(ue[e])return ue[e];for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);for(var n="#",r=0;r<3;r++){n+=("00"+(t>>8*r&255).toString(16)).substr(-2)}return ue[e]=n,n},de={tooltip:{padding:".5rem .75rem",backgroundColor:"rgba(255, 255, 255)",border:"2px solid rgba(0, 0, 0)"}},pe=function(e){if(e.active){var t=e.payload,a=e.label;return i.a.createElement("div",{style:de.tooltip},i.a.createElement(w.a,{variant:"body1",color:"textPrimary"},a),i.a.createElement(w.a,null,"Total Completed:"," ",i.a.createElement("strong",null,t[0].value)))}return null},he=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.sort((function(e,t){return e.questionsCompleted<t.questionsCompleted}));return i.a.createElement(Y.a,{width:"99%",height:280},i.a.createElement(X.a,{data:t,margin:{right:20,bottom:5},maxBarSize:10},i.a.createElement(oe.a,{strokeDasharray:"3 3"}),i.a.createElement(te.a,{dataKey:"username"}),i.a.createElement(ne.a,{dataKey:"questionsCompleted",type:"number",allowDecimals:!1,label:{value:"# of Questions Completed",angle:-90,position:"center"}}),i.a.createElement(ce.a,{content:pe}),i.a.createElement($.a,{name:"Question",dataKey:"questionsCompleted",isAnimationActive:!1},e.map((function(e,t){return i.a.createElement(se.a,{key:"cell-".concat(t),fill:me(e.username)})})))))}}]),a}(i.a.PureComponent),fe=a(757),ve=a.n(fe),be=a(523),Ee=a.n(be),ge={tooltip:{padding:".5rem .75rem",backgroundColor:"rgba(255, 255, 255)",border:"2px solid rgba(0, 0, 0)"}},ye=function(e){return e.name},xe=function(e){if(e.active){var t=e.payload;return i.a.createElement("div",{style:ge.tooltip},i.a.createElement(w.a,{variant:"body1",color:"textPrimary"},t[0].name),i.a.createElement(w.a,null,"".concat(t[0].payload.label,":")," ",i.a.createElement("strong",null,t[0].value)))}return null},je=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.data;return i.a.createElement(Y.a,{width:"99%",height:280},i.a.createElement(ve.a,{margin:{top:50,right:60,left:60,bottom:50}},i.a.createElement(Ee.a,{data:e,nameKey:"set",dataKey:"total",fill:"#8884d8",innerRadius:"70%",outerRadius:"90%",label:ye,labelLine:!1,isAnimationActive:!1},e.map((function(e,t){return i.a.createElement(se.a,{key:t,label:"Total Questions",fill:me(e.set)})}))),i.a.createElement(Ee.a,{isAnimationActive:!1,data:e,nameKey:"set",dataKey:"completed",fill:"#82ca9d",outerRadius:"60%"},e.map((function(e,t){return i.a.createElement(se.a,{key:t,label:"Completed Questions",fill:me(e.set)})}))),i.a.createElement(ce.a,{content:xe})))}}]),a}(i.a.Component),Ce=a(762),Oe=a.n(Ce),ke={tooltip:{padding:".5rem .75rem",backgroundColor:"rgba(255, 255, 255)",border:"2px solid rgba(0, 0, 0)"}},we=function(e){var t=e.depth,a=e.x,n=e.y,r=e.width,o=e.height,l=e.index,c=e.name;return i.a.createElement("g",null,i.a.createElement("rect",{x:a,y:n,width:r,height:o,style:{stroke:"#fff",strokeWidth:2/(t+1e-10),strokeOpacity:1/(t+1e-10)}}),1===t?i.a.createElement(i.a.Fragment,null,i.a.createElement("text",{x:a+r/2,y:n+o/2+7,textAnchor:"middle",fill:"#fff",fontSize:14},c),i.a.createElement("text",{x:a+4,y:n+18,fill:"#fff",fontSize:16,fillOpacity:.9},"Q",l+1)):null)},Se=function(e){if(e.active){var t=e.payload;return i.a.createElement("div",{style:ke.tooltip},i.a.createElement(w.a,{variant:"body1",color:"textPrimary"},"Question ".concat(t[0].payload.index+1)),i.a.createElement(w.a,{color:"textSecondary",gutterBottom:!0},t[0].name),i.a.createElement(w.a,null,"Total Completed:"," ",i.a.createElement("strong",null,t[0].value)))}return null},Ge=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.data;return i.a.createElement(Y.a,{width:"99%",height:280},i.a.createElement(Oe.a,{data:e,dataKey:"completed",nameKey:"title",stroke:"#fff",fill:"#8884d8",isAnimationActive:!1,content:i.a.createElement(we,null)},i.a.createElement(ce.a,{content:Se})))}}]),a}(i.a.PureComponent),He=a(793),Ae=a.n(He),Be=a(791),De=a.n(Be),_e=a(157),qe=a.n(_e),Te=a(102),ze=a.n(Te),Le={smallButton:{padding:6}},Qe=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handleRemoveUser=function(){return e.props.removeHandler(e.props.user._id)},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.dense,n=t.username,r=t.active,o=t.totalQuestions,l=t.questionsCompleted,c=t.canRemove,s=t.updatedAt,u=new Date(s).toLocaleString("en-GB"),m=Math.round(l/o*100),d=m<20?qe.a[500]:m>80?ze.a[500]:"inherit";return i.a.createElement(C.a,{divider:!0,dense:!0},i.a.createElement(w.a,{style:{color:d},title:"".concat(n," has completed ").concat(m,"% (").concat(l,"/").concat(o,") of the questions.")},"".concat(m,"%")),i.a.createElement(O.a,{inset:!0,primary:n,secondary:r?"Active":"Last active ".concat(u)}),c&&i.a.createElement(k.a,null,i.a.createElement(j.a,{style:a&&Le.smallButton||{},color:"secondary",onClick:this.handleRemoveUser,"aria-label":"Remove User from the group"},i.a.createElement(De.a,{fontSize:"small"}))))}}]),a}(i.a.Component),Me=a(275),Re=a(276),Ke=a(106),Pe=(a(792),{closeButton:{marginRight:16},flex:{flex:1}}),Fe=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={error:null,group:null},e.handleUpdateGroup=Object(p.a)(d.a.mark((function t(){var a,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,n=e.state.controlledTitle,t.next=4,Object(_.h)(a,n);case 4:e.setState((function(e){return{group:Object(N.a)({},e.group,{title:n})}}));case 5:case"end":return t.stop()}}),t)}))),e.handleRemoveUser=function(){var t=Object(p.a)(d.a.mark((function t(a){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.f)(e.props.match.params.id,a);case 2:e.setState((function(e){return{group:Object(N.a)({},e.group,{users:Object(J.a)(e.group.users.filter((function(e){return e._id!==a})))})}}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){return e.setState({controlledTitle:t.target.value})},e.loadGroup=Object(p.a)(d.a.mark((function t(){var a,n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.match.params.id,t.prev=1,t.next=4,Object(_.b)(a);case 4:n=t.sent,e.setState({group:n,controlledTitle:n.title}),t.next=14;break;case 8:return t.prev=8,t.t0=t.catch(1),t.next=12,t.t0.text();case 12:r=t.sent,e.setState({error:r});case 14:case"end":return t.stop()}}),t,null,[[1,8]])}))),e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.loadGroup()}},{key:"render",value:function(){var e=this,t=this.props.match.params.title,a=this.state,n=a.group,r=a.error,o=i.a.createElement(Me.a,{position:"static"},i.a.createElement(Re.a,{variant:"dense"},i.a.createElement(j.a,{component:y.b,color:"inherit",to:"/",style:Pe.closeButton,"aria-label":"Close"},i.a.createElement(Ae.a,{fontSize:"small"})),i.a.createElement(w.a,{variant:"h6",color:"inherit",style:Pe.flex},t)));if(!n)return i.a.createElement(i.a.Fragment,null,o,i.a.createElement(E.a,null,i.a.createElement(g.a,{align:"center"},"Loading group information...")));var l=n.users,c=n.questionMetrics,s=n.setMetrics;return r?i.a.createElement(i.a.Fragment,null,o,i.a.createElement(E.a,null,i.a.createElement(g.a,{color:"error",align:"center"},r))):i.a.createElement(i.a.Fragment,null,o,i.a.createElement("div",{style:{margin:16}},i.a.createElement(Q.a,{container:!0,spacing:2},i.a.createElement(Q.a,{item:!0,xs:12,md:4},i.a.createElement(w.a,{variant:"body1",color:"textSecondary",component:"h3",gutterBottom:!0},"Members"),i.a.createElement(Ke.a,{elevation:2,square:!0},i.a.createElement(f.a,{dense:l.length>=5,disablePadding:!0},l.map((function(t){return i.a.createElement(Qe,{key:t._id,user:t,dense:l.length>=5,removeHandler:e.handleRemoveUser})}))))),i.a.createElement(Q.a,{item:!0,xs:12,md:8},i.a.createElement(Q.a,{container:!0},i.a.createElement(Q.a,{item:!0,xs:12},i.a.createElement(w.a,{variant:"body1",color:"textSecondary",component:"h3",gutterBottom:!0},"Group members progress"),i.a.createElement(he,{data:l})),i.a.createElement(Q.a,{item:!0,xs:12,sm:6,xl:3},i.a.createElement(w.a,{variant:"body1",color:"textSecondary",component:"h3",gutterBottom:!0},"Comparison of question set ratio and their corresponding completed ratio"),i.a.createElement(je,{data:s})),i.a.createElement(Q.a,{item:!0,xs:12,sm:6,xl:3},i.a.createElement(w.a,{variant:"body1",color:"textSecondary",component:"h3",gutterBottom:!0},"Comparison of question completion"),i.a.createElement(Ge,{data:c})))))))}}]),a}(i.a.Component),Ue=function(e){Object(l.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handleClose=function(){return e.props.closeHandler()},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.currentGroup,n=t.loadDatabaseHandler,r=t.joinGroupHandler,o=t.leaveGroupHandler;return i.a.createElement(y.a,null,i.a.createElement(u.d,null,i.a.createElement(u.b,{path:"/group/manage/:id/:title",component:function(t){var a=t.match;return i.a.createElement(s.a,{onClose:e.handleClose,open:!0,fullScreen:!0},i.a.createElement(Fe,{match:a,closeHandler:e.handleClose}))}}),i.a.createElement(u.b,{path:"/group/create",render:function(){return i.a.createElement(s.a,{onClose:e.handleClose,open:!0,fullWidth:!0},i.a.createElement(W,{closeHandler:e.handleClose}))}}),i.a.createElement(u.b,{render:function(){return i.a.createElement(s.a,{onClose:e.handleClose,open:!0,fullWidth:!0},i.a.createElement(z,{currentGroup:a,joinGroupHandler:r,leaveGroupHandler:o,loadDatabaseHandler:n,closeHandler:e.handleClose}))}})))}}]),a}(i.a.Component)}}]);
//# sourceMappingURL=groups.c30a924f.chunk.js.map